<!--pages/holiday/index.wxml-->
<view class="container {{themeClass}}">
  <!-- é¡¶éƒ¨æ“ä½œæ  -->
  <view class="header-bar card">
    <view class="year-selector">
      <text class="selector-label">æŸ¥çœ‹å¹´ä»½:</text>
      <picker range="{{yearRange}}" 
              value="{{yearRange.indexOf(currentYear)}}"
              bindchange="onYearChange">
        <view class="year-display">{{currentYear}}å¹´</view>
      </picker>
    </view>
    
    <view class="header-actions">
      <view class="action-icon" bindtap="refreshData">ğŸ”„</view>
      <view class="action-icon" bindtap="viewInstructions">â“</view>
    </view>
  </view>

  <!-- ç»Ÿè®¡ä¿¡æ¯ -->
  <view class="stats-card card">
    <view class="stats-title">æ•°æ®ç»Ÿè®¡</view>
    <view class="stats-grid">
      <view class="stat-item">
        <view class="stat-number">{{stats.totalHolidays}}</view>
        <view class="stat-label">è·å–èŠ‚å‡æ—¥</view>
      </view>
      <view class="stat-item">
        <view class="stat-number">{{stats.totalWorkdays}}</view>
        <view class="stat-label">è·å–è°ƒä¼‘æ—¥</view>
      </view>
      <view class="stat-item">
        <view class="stat-number">{{stats.appliedHolidays}}</view>
        <view class="stat-label">å·²åº”ç”¨èŠ‚å‡æ—¥</view>
      </view>
      <view class="stat-item">
        <view class="stat-number">{{stats.appliedWorkdays}}</view>
        <view class="stat-label">å·²åº”ç”¨è°ƒä¼‘æ—¥</view>
      </view>
    </view>
  </view>

  <!-- èŠ‚å‡æ—¥æ•°æ®åˆ—è¡¨ -->
  <view class="holiday-list">
    <view wx:if="{{loading}}" class="loading-card card">
      <view class="loading-icon">â³</view>
      <view class="loading-text">æ­£åœ¨è·å–èŠ‚å‡æ—¥æ•°æ®...</view>
    </view>
    
    <view wx:else>
      <view wx:for="{{holidayData}}" wx:key="year" class="year-card card fade-in">
        <view class="year-header">
          <view class="year-title">{{item.year}}å¹´</view>
          <view class="year-source">æ•°æ®æº: {{item.source === 'timor' ? 'Timor' : 'Nager'}}</view>
        </view>
        
        <!-- èŠ‚å‡æ—¥åˆ—è¡¨ -->
        <view wx:if="{{item.holidays.length > 0}}" class="holiday-section">
          <view class="section-header" 
                bindtap="viewHolidayDetail" 
                data-year="{{item.year}}" 
                data-type="holidays">
            <text class="section-title">èŠ‚å‡æ—¥ ({{item.holidays.length}}ä¸ª)</text>
            <text class="section-arrow">ğŸ‘ï¸</text>
          </view>
          
          <view class="holiday-items">
            <view wx:for="{{item.holidays}}" 
                  wx:for-item="holiday" 
                  wx:key="date" 
                  class="holiday-item holiday-type">
              <view class="holiday-date">{{holiday.date}}</view>
              <view class="holiday-name">{{holiday.name}}</view>
            </view>
          </view>
        </view>
        
        <!-- è°ƒä¼‘æ—¥åˆ—è¡¨ -->
        <view wx:if="{{item.workdays.length > 0}}" class="workday-section">
          <view class="section-header" 
                bindtap="viewHolidayDetail" 
                data-year="{{item.year}}" 
                data-type="workdays">
            <text class="section-title">è°ƒä¼‘æ—¥ ({{item.workdays.length}}ä¸ª)</text>
            <text class="section-arrow">ğŸ‘ï¸</text>
          </view>
          
          <view class="workday-items">
            <view wx:for="{{item.workdays}}" 
                  wx:for-item="workday" 
                  wx:key="date" 
                  class="workday-item workday-type">
              <view class="workday-date">{{workday.date}}</view>
              <view class="workday-name">{{workday.name}}</view>
            </view>
          </view>
        </view>
        
        <!-- ç©ºæ•°æ®æç¤º -->
        <view wx:if="{{item.holidays.length === 0 && item.workdays.length === 0}}" 
              class="empty-year">
          <text>æš‚æ— {{item.year}}å¹´çš„èŠ‚å‡æ—¥æ•°æ®</text>
        </view>
      </view>
      
      <!-- æ— æ•°æ®æç¤º -->
      <view wx:if="{{holidayData.length === 0}}" class="empty-state card">
        <view class="empty-icon">ğŸ“…</view>
        <view class="empty-text">æš‚æ— èŠ‚å‡æ—¥æ•°æ®</view>
        <view class="empty-desc">ç‚¹å‡»åˆ·æ–°æŒ‰é’®è·å–æœ€æ–°æ•°æ®</view>
      </view>
    </view>
  </view>

  <!-- åº•éƒ¨æ“ä½œæŒ‰é’® -->
  <view class="bottom-actions">
    <view class="action-button primary" bindtap="applyHolidaySettings">
      <text class="button-icon">âœ…</text>
      <text class="button-text">åº”ç”¨åˆ°åå¥½</text>
    </view>
    
    <view class="action-button secondary" bindtap="clearHolidaySettings">
      <text class="button-icon">ğŸ—‘ï¸</text>
      <text class="button-text">æ¸…é™¤è®¾ç½®</text>
    </view>
    
    <view class="action-button info" bindtap="exportHolidayData">
      <text class="button-icon">ğŸ“‹</text>
      <text class="button-text">å¯¼å‡ºæ•°æ®</text>
    </view>
  </view>

  <!-- è¯´æ˜æ–‡å­— -->
  <view class="help-text">
    <text class="help-item">â€¢ åº”ç”¨åå°†å½±å“"ä»Šæ—¥æ”¶ç›Š"å’Œ"é€€ä¼‘å€’è®¡æ—¶"çš„ç²¾ç¡®è®¡ç®—</text>
    <text class="help-item">â€¢ æ•°æ®æ¥æºäºç¬¬ä¸‰æ–¹APIï¼Œä»…ä¾›å‚è€ƒ</text>
    <text class="help-item">â€¢ å»ºè®®æ¯å¹´æ›´æ–°ä¸€æ¬¡èŠ‚å‡æ—¥æ•°æ®</text>
  </view>
</view>
